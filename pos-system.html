<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>POS System - Admin</title>
    <link rel="stylesheet" href="superadmin.css">
    <link rel="stylesheet" href="pos-system.css">
</head>
<body>
    <div class="pos-container">
        <!-- Sidebar -->
        <aside class="pos-sidebar" id="posSidebar">
            <div class="sidebar-header">
                <div>
                    <h2>üè™ POS</h2>
                    <p id="adminName">Admin</p>
                    <div id="licenseStatus" style="margin-top: 8px; font-size: 11px; padding: 4px 8px; background: rgba(255,255,255,0.2); border-radius: 12px; display: inline-block;">
                        <span id="licenseText">Trial</span>
                    </div>
                </div>
                <button class="sidebar-toggle" onclick="toggleSidebar()" title="Toggle Sidebar">
                    <span id="toggleIcon" class="hamburger-icon">
                        <span></span>
                        <span></span>
                        <span></span>
                    </span>
                </button>
            </div>
            <nav class="sidebar-menu">
                <a href="#" class="sidebar-item active" onclick="showPOSView()" data-tooltip="Sales">
                    <span class="item-icon">üõí</span>
                    <span class="item-text">Sales</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showInventoryManagement()" data-tooltip="Inventory">
                    <span class="item-icon">üì¶</span>
                    <span class="item-text">Inventory</span>
                    <span class="notification-badge" id="lowStockBadge" style="display: none;">0</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showClientManagement()" data-tooltip="Clients">
                    <span class="item-icon">üë•</span>
                    <span class="item-text">Clients</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showSubdealerManagement()" data-tooltip="Subdealers">
                    <span class="item-icon">ü§ù</span>
                    <span class="item-text">Subdealers</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showFinancialReports()" data-tooltip="Reports">
                    <span class="item-icon">üí∞</span>
                    <span class="item-text">Reports</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showLicenseManagement()" data-tooltip="License">
                    <span class="item-icon">üîë</span>
                    <span class="item-text">License</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showDashboard()" data-tooltip="Analytics">
                    <span class="item-icon">üìä</span>
                    <span class="item-text">Analytics</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showAdvancedReport()" data-tooltip="Reports">
                    <span class="item-icon">üìã</span>
                    <span class="item-text">Reports</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showUserManagement()" data-tooltip="Users">
                    <span class="item-icon">üë§</span>
                    <span class="item-text">Users</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showSupplierModal()" data-tooltip="Suppliers">
                    <span class="item-icon">üè≠</span>
                    <span class="item-text">Suppliers</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showReturnModal()" data-tooltip="Returns">
                    <span class="item-icon">üîÑ</span>
                    <span class="item-text">Returns</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showDiscountModal()" data-tooltip="Discounts">
                    <span class="item-icon">üéÅ</span>
                    <span class="item-text">Discounts</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showExpenseModal()" data-tooltip="Expenses">
                    <span class="item-icon">üí∏</span>
                    <span class="item-text">Expenses</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showCashRegister()" data-tooltip="Cash Register">
                    <span class="item-icon">ÔøΩ</span>
                    <span class="item-text">Cash Register</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showPurchaseOrder()" data-tooltip="Purchase Orders">
                    <span class="item-icon">ÔøΩ</span>
                    <span class="item-text">Purchase Orders</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showActivityLogs()" data-tooltip="Activity Logs">
                    <span class="item-icon">ÔøΩ</spann>
                    <span class="item-text">Activity Logs</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showBarcodeModal()" data-tooltip="Barcode">
                    <span class="item-icon">üì∑</span>
                    <span class="item-text">Barcode</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showShortcutsModal()" data-tooltip="Shortcuts">
                    <span class="item-icon">‚å®Ô∏è</span>
                    <span class="item-text">Shortcuts</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showBackupModal()" data-tooltip="Backup">
                    <span class="item-icon">ÔøΩ</sppan>
                    <span class="item-text">Backup</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showSettingsModal()" data-tooltip="Settings">
                    <span class="item-icon">‚öôÔ∏è</span>
                    <span class="item-text">Settings</span>
                </a>
                <a href="admin-panel.html" class="sidebar-item" data-tooltip="Dashboard">
                    <span class="item-icon">üè†</span>
                    <span class="item-text">Dashboard</span>
                </a>
                <a href="#" class="sidebar-item" onclick="logoutFromPOS(); return false;" data-tooltip="Logout">
                    <span class="item-icon">üö™</span>
                    <span class="item-text">Logout</span>
                </a>
                <a href="#" class="sidebar-item" onclick="showUserDataHistory()" data-tooltip="Data History">
                    <span class="item-icon">ÔøΩ</span>
                    <span class="item-text">Data History</span>
                </a>
                <a href="#" class="sidebar-item chat-support" onclick="openChatbot(); return false;" data-tooltip="Chat Support">
                    <span class="item-icon">ÔøΩ</span>
                    <span class="item-text">Chat Support</span>
                </a>
            </nav>
            
            <!-- Notifications - Hidden -->
            <div id="notificationPanel" style="display: none; padding: 15px; margin: 15px; background: rgba(255, 255, 255, 0.1); border-radius: 10px; cursor: pointer;" onclick="toggleNotificationList()">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 10px;">
                    <div style="font-weight: 600; color: white;">üîî Notifications</div>
                    <span id="notificationBadge" style="background: #dc3545; color: white; padding: 2px 8px; border-radius: 10px; font-size: 11px; display: none;">0</span>
                </div>
                <div id="notificationList" style="display: none; max-height: 300px; overflow-y: auto; margin-top: 10px;"></div>
            </div>
            
            <!-- Low Stock Alert - Hidden by default -->
            <div id="lowStockAlert" style="display: none; padding: 15px; margin: 15px; background: #fff3cd; border-radius: 8px; border-left: 4px solid #ffc107; max-height: 150px; overflow-y: auto;">
                <div style="font-weight: 600; color: #856404; margin-bottom: 5px;">‚ö†Ô∏è Low Stock Alert</div>
                <div id="lowStockList" style="font-size: 13px; color: #856404;"></div>
            </div>
        </aside>

        <div class="pos-main">
            <!-- Left Side - Products -->
            <div class="products-section">
                <div class="search-bar">
                    <input type="text" id="searchInput" placeholder="üîç Search products..." onkeyup="searchProducts()">
                    <select id="categoryFilter" onchange="filterByCategory()">
                        <option value="all">All Categories</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Accessories">Accessories</option>
                        <option value="Audio">Audio</option>
                        <option value="Mobile">Mobile</option>
                        <option value="Computer">Computer</option>
                        <option value="Gaming">Gaming</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="products-grid" id="productsGrid">
                    <!-- Products will be loaded here -->
                </div>
            </div>

            <!-- Right Side - Cart -->
            <div class="cart-section">
                <h2>üõí Cart Items</h2>
                <div class="cart-items" id="cartItems">
                    <p class="empty-cart">No items in cart</p>
                </div>

                <!-- Cart Summary -->
                <div class="cart-summary">
                    <div class="summary-row">
                        <span>Subtotal:</span>
                        <span id="subtotal">Rs. 0</span>
                    </div>
                    <div class="summary-row">
                        <span>Tax (0%):</span>
                        <span id="tax">Rs. 0</span>
                    </div>
                    <div class="summary-row total">
                        <span>Total:</span>
                        <span id="total">Rs. 0</span>
                    </div>
                    
                    <div class="payment-section">
                        <div class="input-group">
                            <label>Customer Paid: <small style="color: #999; font-weight: normal;">(Optional - for change calculation)</small></label>
                            <input type="number" id="customerPaid" placeholder="Optional - Enter if customer pays extra" min="0" onkeyup="calculateChange()">
                        </div>
                        <div class="summary-row change">
                            <span>Change/Return:</span>
                            <span id="change">Rs. 0</span>
                        </div>
                    </div>

                    <div class="action-buttons">
                        <button class="btn-checkout" onclick="checkout()">üí≥ Checkout</button>
                        <button class="btn-print" onclick="printReceipt()">üñ®Ô∏è Print</button>
                        <button class="btn-clear" onclick="clearCart()">üóëÔ∏è Clear</button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Payment Method Modal -->
    <div id="paymentModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closePaymentModal()">&times;</span>
            <h2>üí≥ Payment Method</h2>
            
            <div class="payment-method-selection">
                <button class="payment-method-btn cash-btn" onclick="selectPaymentMethod('cash')">
                    <span style="font-size: 40px;">üíµ</span>
                    <h3>Cash Payment</h3>
                    <p>Direct cash payment</p>
                </button>
                <button class="payment-method-btn credit-btn" onclick="selectPaymentMethod('credit')">
                    <span style="font-size: 40px;">üìù</span>
                    <h3>Credit Sale</h3>
                    <p>Payment on credit</p>
                </button>
            </div>
            
            <!-- Credit Sale Section (Hidden by default) -->
            <div id="creditSection" style="display: none; margin-top: 20px;">
                <h3>Select Client</h3>
                <div class="input-group">
                    <input type="text" id="clientSearch" placeholder="üîç Search client by name or contact..." onkeyup="searchClients()">
                </div>
                
                <div id="clientsList" style="max-height: 200px; overflow-y: auto; margin: 15px 0;">
                    <!-- Clients will be loaded here -->
                </div>
                
                <button class="btn-secondary" onclick="showAddClientModal()" style="width: 100%; margin-top: 10px;">
                    ‚ûï Add New Client
                </button>
                
                <div id="selectedClientInfo" style="display: none; background: #f8f9fa; padding: 15px; border-radius: 8px; margin-top: 15px;">
                    <h4>Selected Client:</h4>
                    <p id="selectedClientName"></p>
                    <p id="selectedClientContact"></p>
                    <p id="selectedClientBalance"></p>
                </div>
                
                <button class="btn-primary" onclick="confirmCreditSale()" style="width: 100%; margin-top: 15px; display: none;" id="confirmCreditBtn">
                    ‚úÖ Confirm Credit Sale
                </button>
            </div>
        </div>
    </div>
    
    <!-- Add Client Modal -->
    <div id="addClientModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddClientModal()">&times;</span>
            <h2>Add New Client</h2>
            <form id="addClientForm">
                <div class="input-group">
                    <label>Client Name</label>
                    <input type="text" id="newClientName" required>
                </div>
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="newClientContact" required>
                </div>
                <div class="input-group">
                    <label>Address</label>
                    <textarea id="newClientAddress" rows="2"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Client</button>
            </form>
        </div>
    </div>
    
    <!-- Client Management Modal -->
    <div id="clientManagementModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeClientManagement()">&times;</span>
            <h2>üë• Client Management</h2>
            <button class="btn-primary" onclick="showAddClientModalFromManagement()" style="margin-bottom: 15px;">‚ûï Add New Client</button>
            
            <div class="input-group">
                <input type="text" id="clientManagementSearch" placeholder="üîç Search clients..." onkeyup="searchClientsInManagement()">
            </div>
            
            <div id="clientManagementList" style="max-height: 400px; overflow-y: auto;">
                <!-- Clients will be loaded here -->
            </div>
        </div>
    </div>
    
    <!-- Inventory Management Modal -->
    <div id="inventoryManagementModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeInventoryManagement()">&times;</span>
            <h2>üì¶ Inventory Management</h2>
            <button class="btn-primary" onclick="showAddProductModal()" style="margin-bottom: 15px;">‚ûï Add New Product</button>
            
            <div class="input-group">
                <input type="text" id="inventorySearch" placeholder="üîç Search products..." onkeyup="searchInventory()">
            </div>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Product</th>
                            <th>Category</th>
                            <th>Price</th>
                            <th>Stock</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="inventoryManagementBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Add/Edit Product Modal -->
    <div id="addProductModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddProductModal()">&times;</span>
            <h2 id="productModalTitle">Add New Product</h2>
            <form id="addProductForm">
                <input type="hidden" id="editProductIndex" value="-1">
                
                <!-- Current Image Preview -->
                <div class="input-group" style="text-align: center;">
                    <img id="currentProductImage" src="" alt="Product" style="max-width: 200px; max-height: 200px; border-radius: 8px; display: none; margin: 0 auto;">
                </div>
                
                <div class="input-group">
                    <label>Product Image</label>
                    <input type="file" id="productImage" accept="image/*" onchange="previewProductImage(event)">
                    <small style="color: #666;">Upload product image (optional, all sizes supported)</small>
                </div>
                
                <div class="input-group">
                    <label>Product Name</label>
                    <input type="text" id="productName" required>
                </div>
                <div class="input-group">
                    <label>Category</label>
                    <select id="productCategory" onchange="checkOtherCategory()" required>
                        <option value="">Select Category</option>
                        <option value="Electronics">Electronics</option>
                        <option value="Accessories">Accessories</option>
                        <option value="Audio">Audio</option>
                        <option value="Mobile">Mobile</option>
                        <option value="Computer">Computer</option>
                        <option value="Gaming">Gaming</option>
                        <option value="Clothing">Clothing</option>
                        <option value="Food">Food & Beverages</option>
                        <option value="Books">Books & Stationery</option>
                        <option value="Sports">Sports & Fitness</option>
                        <option value="Beauty">Beauty & Health</option>
                        <option value="Home">Home & Kitchen</option>
                        <option value="Toys">Toys & Games</option>
                        <option value="Automotive">Automotive</option>
                        <option value="Other">Other (Custom)</option>
                    </select>
                </div>
                <div class="input-group" id="customCategoryGroup" style="display: none;">
                    <label>Custom Category Name</label>
                    <input type="text" id="customCategory" placeholder="Enter custom category">
                </div>
                <div class="input-group">
                    <label>Cost Price (Rs.) - Purchase Price</label>
                    <input type="number" id="productCostPrice" min="0" step="0.01" required>
                </div>
                <div class="input-group">
                    <label>Sale Price (Rs.) - Selling Price</label>
                    <input type="number" id="productPrice" min="0" step="0.01" required>
                </div>
                <div class="input-group">
                    <label>Stock Quantity</label>
                    <input type="number" id="productStock" min="0" required>
                </div>
                <div class="input-group">
                    <label>Stock Arrival Date</label>
                    <input type="date" id="productArrivalDate" value="">
                </div>
                <div class="input-group">
                    <label>Barcode (Optional)</label>
                    <input type="text" id="productBarcode" placeholder="Enter barcode number">
                </div>
                <div class="input-group">
                    <label>Expiry Date (Optional)</label>
                    <input type="date" id="productExpiry">
                </div>
                <div class="input-group">
                    <label>Icon (Emoji - if no image)</label>
                    <input type="text" id="productIcon" placeholder="üì¶" maxlength="2">
                </div>
                <button type="submit" class="btn-primary" id="productSubmitBtn">Add Product</button>
            </form>
        </div>
    </div>

    <!-- License Purchase Form Modal -->
    <div id="licensePurchaseFormModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeLicensePurchaseForm()">&times;</span>
            <h2>üìù License Purchase Application</h2>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; margin: 15px 0; border-left: 4px solid #28a745;">
                <div style="font-weight: 600; color: #2e7d32;">Selected License:</div>
                <div id="selectedLicenseInfo" style="color: #2e7d32; margin-top: 5px;"></div>
            </div>
            
            <form id="licensePurchaseForm">
                <div class="input-group">
                    <label>Shop Name *</label>
                    <input type="text" id="shopNameInput" required placeholder="Enter your shop name">
                </div>
                
                <div class="input-group">
                    <label>Owner Name *</label>
                    <input type="text" id="ownerNameInput" required placeholder="Enter owner name">
                </div>
                
                <div class="input-group">
                    <label>Mobile Number *</label>
                    <input type="tel" id="mobileInput" required placeholder="03XX-XXXXXXX">
                </div>
                
                <div class="input-group">
                    <label>ID Card Number (CNIC) *</label>
                    <input type="text" id="cnicInput" required placeholder="XXXXX-XXXXXXX-X">
                </div>
                
                <div class="input-group">
                    <label>Shop Address *</label>
                    <textarea id="addressInput" rows="3" required placeholder="Enter complete shop address"></textarea>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%; padding: 15px; font-size: 16px;">
                    ‚úÖ Submit Application
                </button>
            </form>
        </div>
    </div>
    
    <!-- Thank You Modal -->
    <div id="thankYouModal" class="modal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <div style="font-size: 80px; margin: 20px 0;">üéâ</div>
            <h2 style="color: #28a745; margin: 20px 0;">Thank You for Your Purchase!</h2>
            <p style="font-size: 18px; color: #666; margin: 20px 0;">
                Your license application has been submitted successfully.
            </p>
            <div style="background: #fff3cd; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <p style="color: #856404; margin: 0;">
                    <strong>‚è≥ Pending Approval</strong><br><br>
                    Our superadmin will review your application and approve your license key shortly.
                    You will be notified once approved!
                </p>
            </div>
            <button class="btn-primary" onclick="closeThankYouModal()" style="padding: 12px 40px; font-size: 16px;">
                Got it! üëç
            </button>
        </div>
    </div>
    
    <!-- License Management Modal -->
    <div id="licenseManagementModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeLicenseManagement()">&times;</span>
            <h2>üîë License Management</h2>
            
            <!-- Current License Status -->
            <div id="currentLicenseInfo" style="background: #f8f9fa; padding: 20px; border-radius: 10px; margin: 20px 0;">
                <h3 style="margin: 0 0 15px 0;">Current License Status</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <strong>License Type:</strong><br>
                        <span id="currentLicenseType" style="color: #667eea; font-size: 18px;">Trial</span>
                    </div>
                    <div>
                        <strong>Status:</strong><br>
                        <span id="currentLicenseStatus" style="color: #ffc107; font-size: 18px;">‚ö†Ô∏è Inactive</span>
                    </div>
                    <div>
                        <strong>Expiry Date:</strong><br>
                        <span id="currentExpiryDate">N/A</span>
                    </div>
                    <div>
                        <strong>Days Left:</strong><br>
                        <span id="currentDaysLeft">N/A</span>
                    </div>
                </div>
            </div>
            
            <!-- License Options -->
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                <div style="border: 2px solid #667eea; border-radius: 10px; padding: 20px; text-align: center;">
                    <h3 style="color: #667eea; margin: 0 0 10px 0;">Monthly License</h3>
                    <div style="font-size: 32px; font-weight: bold; color: #667eea; margin: 15px 0;">Rs. 1,000</div>
                    <div style="color: #666; font-size: 14px; margin-bottom: 15px;">30 Days Access</div>
                    <button class="btn-primary" onclick="buyLicense('monthly')" style="width: 100%;">üí≥ Buy Now</button>
                </div>
                
                <div style="border: 2px solid #28a745; border-radius: 10px; padding: 20px; text-align: center; position: relative;">
                    <div style="position: absolute; top: -10px; right: 10px; background: #28a745; color: white; padding: 3px 10px; border-radius: 12px; font-size: 11px;">BEST VALUE</div>
                    <h3 style="color: #28a745; margin: 0 0 10px 0;">Lifetime License</h3>
                    <div style="font-size: 32px; font-weight: bold; color: #28a745; margin: 15px 0;">Rs. 5,000</div>
                    <div style="color: #666; font-size: 14px; margin-bottom: 15px;">Unlimited Access</div>
                    <button class="btn-primary" onclick="buyLicense('lifetime')" style="width: 100%; background: #28a745;">üíé Buy Now</button>
                </div>
            </div>
            
            <!-- Activate License -->
            <div style="border-top: 2px solid #e0e0e0; padding-top: 20px; margin-top: 20px;">
                <h3>Already have a license key?</h3>
                <div class="input-group">
                    <label>Enter License Key</label>
                    <input type="text" id="licenseKeyInput" placeholder="XXXX-XXXX-XXXX-XXXX" style="text-transform: uppercase;">
                </div>
                <button class="btn-primary" onclick="activateLicense()" style="width: 100%;">üîì Activate License</button>
            </div>
            
            <!-- 7 Days Demo Account -->
            <div style="border-top: 2px solid #e0e0e0; padding-top: 20px; margin-top: 20px;">
                <h3>Try Before You Buy</h3>
                <div style="background: #e3f2fd; padding: 15px; border-radius: 8px; margin: 10px 0;">
                    <div style="font-weight: 600; color: #1976d2; margin-bottom: 5px;">üéÅ 7 Days Free Demo</div>
                    <div style="color: #1565c0; font-size: 14px;">Test all features for free!</div>
                </div>
                <button class="btn-primary" onclick="activateDemoAccount()" style="width: 100%; background: #2196f3;">
                    üöÄ Activate 7 Days Demo
                </button>
            </div>
        </div>
    </div>
    
    <!-- Financial Reports Modal -->
    <div id="financialReportsModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <span class="close" onclick="closeFinancialReports()">&times;</span>
            <h2>üí∞ Financial Reports</h2>
            
            <!-- Summary Cards -->
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Total Shop Cost</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="totalShopCost">Rs. 0</div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Inventory Value</div>
                </div>
                
                <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Total Sales</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="totalSalesAmount">Rs. 0</div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Cash Collected</div>
                </div>
                
                <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Shop Balance</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="shopBalance">Rs. 0</div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Current Cash</div>
                </div>
                
                <div style="background: linear-gradient(135deg, #17a2b8 0%, #138496 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Total Profit</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="totalProfit">Rs. 0</div>
                    <div style="font-size: 12px; opacity: 0.8; margin-top: 5px;">Net Earnings</div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div style="display: flex; gap: 10px; border-bottom: 2px solid #e0e0e0; margin: 20px 0;">
                <button class="report-tab active" onclick="showReportTab('inventory')">üì¶ Inventory</button>
                <button class="report-tab" onclick="showReportTab('sales')">üíµ Sales</button>
                <button class="report-tab" onclick="showReportTab('profit')">üìà Profit</button>
            </div>
            
            <!-- Inventory Report -->
            <div id="inventoryReport" class="report-content active">
                <h3>Inventory Details</h3>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Stock</th>
                                <th>Cost Price</th>
                                <th>Total Value</th>
                                <th>Arrival Date</th>
                            </tr>
                        </thead>
                        <tbody id="inventoryReportBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Sales Report -->
            <div id="salesReport" class="report-content">
                <h3>Sales Transactions</h3>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Receipt #</th>
                                <th>Date</th>
                                <th>Items</th>
                                <th>Amount</th>
                                <th>Payment</th>
                                <th>Admin</th>
                            </tr>
                        </thead>
                        <tbody id="salesReportBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Profit Report -->
            <div id="profitReport" class="report-content">
                <h3>Profit Analysis</h3>
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Sold Qty</th>
                                <th>Cost Price</th>
                                <th>Sale Price</th>
                                <th>Profit/Unit</th>
                                <th>Total Profit</th>
                            </tr>
                        </thead>
                        <tbody id="profitReportBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Subdealer Management Modal -->
    <div id="subdealerManagementModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeSubdealerManagement()">&times;</span>
            <h2>ü§ù Subdealer Management</h2>
            <button class="btn-primary" onclick="showAddSubdealerModal()" style="margin-bottom: 15px;">‚ûï Add New Subdealer</button>
            
            <div class="input-group">
                <input type="text" id="subdealerSearch" placeholder="üîç Search subdealers..." onkeyup="searchSubdealers()">
            </div>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Name</th>
                            <th>Contact</th>
                            <th>Shop Name</th>
                            <th>Balance</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="subdealerManagementBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Add Subdealer Modal -->
    <div id="addSubdealerModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddSubdealerModal()">&times;</span>
            <h2>Add New Subdealer</h2>
            <form id="addSubdealerForm">
                <div class="input-group">
                    <label>Subdealer Name</label>
                    <input type="text" id="subdealerName" required>
                </div>
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="subdealerContact" required>
                </div>
                <div class="input-group">
                    <label>Shop Name</label>
                    <input type="text" id="subdealerShop" required>
                </div>
                <div class="input-group">
                    <label>Address</label>
                    <textarea id="subdealerAddress" rows="2"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Subdealer</button>
            </form>
        </div>
    </div>
    
    <!-- Subdealer Ledger Modal -->
    <div id="subdealerLedgerModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeSubdealerLedger()">&times;</span>
            <h2 id="subdealerLedgerName">Subdealer Ledger</h2>
            <div id="subdealerLedgerInfo" style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;"></div>
            
            <div style="margin-bottom: 15px;">
                <button class="btn-primary" onclick="showAddSubdealerTransaction()">‚ûï Add Transaction</button>
            </div>
            
            <div class="table-container">
                <table class="data-table">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Description</th>
                            <th>Debit</th>
                            <th>Credit</th>
                            <th>Balance</th>
                            <th>Admin</th>
                        </tr>
                    </thead>
                    <tbody id="subdealerLedgerBody"></tbody>
                </table>
            </div>
        </div>
    </div>
    
    <!-- Add Subdealer Transaction Modal -->
    <div id="addSubdealerTransactionModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddSubdealerTransaction()">&times;</span>
            <h2>Add Transaction</h2>
            <form id="addSubdealerTransactionForm">
                <div class="input-group">
                    <label>Transaction Type</label>
                    <select id="transactionType" required>
                        <option value="debit">Debit (Subdealer owes you)</option>
                        <option value="credit">Credit (Payment received)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Amount (Rs.)</label>
                    <input type="number" id="transactionAmount" min="0" step="0.01" required>
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="transactionDescription" rows="2" required></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Transaction</button>
            </form>
        </div>
    </div>

    <!-- Subdealer Workers Management Modal -->
    <div id="subdealerWorkersModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeSubdealerWorkers()">&times;</span>
            <h2 id="subdealerWorkersTitle">üë∑ Subdealer Workers & Branches</h2>
            
            <div id="subdealerWorkersInfo" style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px; margin-bottom: 20px;">
                <h3 style="margin: 0 0 10px 0;" id="workerSubdealerName">Subdealer Name</h3>
                <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                    <div>
                        <strong>Shop:</strong> <span id="workerSubdealerShop"></span>
                    </div>
                    <div>
                        <strong>Contact:</strong> <span id="workerSubdealerContact"></span>
                    </div>
                </div>
            </div>
            
            <!-- Tabs -->
            <div style="display: flex; gap: 10px; border-bottom: 2px solid #e0e0e0; margin: 20px 0;">
                <button class="report-tab active" onclick="showWorkerTab('workers')">üë∑ Workers</button>
                <button class="report-tab" onclick="showWorkerTab('branches')">üè¢ Branches</button>
            </div>
            
            <!-- Workers Tab -->
            <div id="workersTab" class="report-content active">
                <button class="btn-primary" onclick="showAddWorkerModal()" style="margin-bottom: 15px;">‚ûï Add Worker</button>
                
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Worker ID</th>
                                <th>Name</th>
                                <th>Contact</th>
                                <th>Role</th>
                                <th>Assigned Branch</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="workersTableBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Branches Tab -->
            <div id="branchesTab" class="report-content">
                <button class="btn-primary" onclick="showAddBranchModal()" style="margin-bottom: 15px;">‚ûï Add Branch</button>
                
                <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                    <table class="data-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Branch Name</th>
                                <th>Location</th>
                                <th>Manager</th>
                                <th>Workers Count</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="branchesTableBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Add Worker Modal -->
    <div id="addWorkerModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddWorkerModal()">&times;</span>
            <h2 id="workerModalTitle">Add New Worker</h2>
            <form id="addWorkerForm">
                <input type="hidden" id="editWorkerIndex" value="-1">
                
                <div class="input-group">
                    <label>Worker ID</label>
                    <input type="text" id="workerID" required placeholder="e.g., WRK001">
                </div>
                
                <div class="input-group">
                    <label>Worker Name</label>
                    <input type="text" id="workerName" required>
                </div>
                
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="workerContact" required>
                </div>
                
                <div class="input-group">
                    <label>Role</label>
                    <select id="workerRole" required>
                        <option value="">Select Role</option>
                        <option value="Salesperson">Salesperson</option>
                        <option value="Cashier">Cashier</option>
                        <option value="Manager">Manager</option>
                        <option value="Stock Manager">Stock Manager</option>
                        <option value="Delivery">Delivery</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label>Assign Branch</label>
                    <select id="workerBranch" required>
                        <option value="">Select Branch</option>
                        <option value="Main Branch">Main Branch</option>
                    </select>
                </div>
                
                <div class="input-group">
                    <label>Salary (Rs.)</label>
                    <input type="number" id="workerSalary" min="0" step="1000">
                </div>
                
                <button type="submit" class="btn-primary" id="workerSubmitBtn">Add Worker</button>
            </form>
        </div>
    </div>
    
    <!-- Add Branch Modal -->
    <div id="addBranchModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddBranchModal()">&times;</span>
            <h2 id="branchModalTitle">Add New Branch</h2>
            <form id="addBranchForm">
                <input type="hidden" id="editBranchIndex" value="-1">
                
                <div class="input-group">
                    <label>Branch Name</label>
                    <input type="text" id="branchName" required placeholder="e.g., Downtown Branch">
                </div>
                
                <div class="input-group">
                    <label>Location/Address</label>
                    <textarea id="branchLocation" rows="3" required></textarea>
                </div>
                
                <div class="input-group">
                    <label>Branch Manager</label>
                    <input type="text" id="branchManager" placeholder="Manager name (optional)">
                </div>
                
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="branchContact" required>
                </div>
                
                <button type="submit" class="btn-primary" id="branchSubmitBtn">Add Branch</button>
            </form>
        </div>
    </div>

    <!-- Purchase Orders Modal -->
    <div id="purchaseOrdersModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <span class="close" onclick="closePurchaseOrders()">&times;</span>
            <h2>üìù Purchase Orders</h2>
            <button class="btn-primary" onclick="showAddPurchaseOrder()" style="margin-bottom: 15px;">‚ûï New Purchase Order</button>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>PO Number</th>
                            <th>Supplier</th>
                            <th>Date</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="purchaseOrdersBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Purchase Order Modal -->
    <div id="addPurchaseOrderModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeAddPurchaseOrder()">&times;</span>
            <h2>New Purchase Order</h2>
            <form id="addPurchaseOrderForm">
                <div class="input-group">
                    <label>Supplier</label>
                    <select id="poSupplier" required>
                        <option value="">Select Supplier</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Product</label>
                    <select id="poProduct" required>
                        <option value="">Select Product</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Quantity</label>
                    <input type="number" id="poQuantity" min="1" required>
                </div>
                <div class="input-group">
                    <label>Unit Cost (Rs.)</label>
                    <input type="number" id="poUnitCost" min="0" step="0.01" required>
                </div>
                <div class="input-group">
                    <label>Expected Delivery Date</label>
                    <input type="date" id="poDeliveryDate" required>
                </div>
                <div class="input-group">
                    <label>Notes</label>
                    <textarea id="poNotes" rows="2"></textarea>
                </div>
                <button type="submit" class="btn-primary">Create Purchase Order</button>
            </form>
        </div>
    </div>

    <!-- Expense Tracking Modal -->
    <div id="expenseModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeExpenseTracking()">&times;</span>
            <h2>üí∏ Expense Tracking</h2>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Today's Expenses</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="todayExpenses">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">This Month</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="monthExpenses">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Total Expenses</div>
                    <div style="font-size: 24px; font-weight: bold; margin-top: 5px;" id="totalExpenses">Rs. 0</div>
                </div>
            </div>
            
            <button class="btn-primary" onclick="showAddExpense()" style="margin-bottom: 15px;">‚ûï Add Expense</button>
            
            <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Category</th>
                            <th>Description</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="expenseBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div id="addExpenseModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddExpense()">&times;</span>
            <h2>Add Expense</h2>
            <form id="addExpenseForm">
                <div class="input-group">
                    <label>Category</label>
                    <select id="expenseCategory" required>
                        <option value="">Select Category</option>
                        <option value="Rent">Rent</option>
                        <option value="Utilities">Utilities (Electricity, Water)</option>
                        <option value="Salary">Salary</option>
                        <option value="Inventory">Inventory Purchase</option>
                        <option value="Transport">Transport</option>
                        <option value="Maintenance">Maintenance</option>
                        <option value="Marketing">Marketing</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Amount (Rs.)</label>
                    <input type="number" id="expenseAmount" min="0" step="1" required>
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="expenseDescription" rows="2" required></textarea>
                </div>
                <div class="input-group">
                    <label>Date</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <button type="submit" class="btn-primary">Add Expense</button>
            </form>
        </div>
    </div>

    <!-- Cash Register Modal -->
    <div id="cashRegisterModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeCashRegister()">&times;</span>
            <h2>üíµ Daily Cash Register</h2>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 20px; margin-bottom: 20px;">
                <div style="background: #e8f5e9; padding: 20px; border-radius: 10px; border-left: 4px solid #28a745;">
                    <div style="font-size: 14px; color: #2e7d32;">Opening Balance</div>
                    <div style="font-size: 28px; font-weight: bold; color: #28a745;" id="openingBalance">Rs. 0</div>
                </div>
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; border-left: 4px solid #2196f3;">
                    <div style="font-size: 14px; color: #1565c0;">Current Balance</div>
                    <div style="font-size: 28px; font-weight: bold; color: #2196f3;" id="currentBalance">Rs. 0</div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 20px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 12px; color: #666;">Cash Sales</div>
                    <div style="font-weight: 600; color: #28a745;" id="cashSales">Rs. 0</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 12px; color: #666;">Cash In</div>
                    <div style="font-weight: 600; color: #28a745;" id="cashIn">Rs. 0</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 12px; color: #666;">Cash Out</div>
                    <div style="font-weight: 600; color: #dc3545;" id="cashOut">Rs. 0</div>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; text-align: center;">
                    <div style="font-size: 12px; color: #666;">Refunds</div>
                    <div style="font-weight: 600; color: #dc3545;" id="cashRefunds">Rs. 0</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <button class="btn-primary" onclick="showCashIn()">üí∞ Cash In</button>
                <button class="btn-primary" onclick="showCashOut()" style="background: #dc3545;">üí∏ Cash Out</button>
                <button class="btn-primary" onclick="closeDayRegister()" style="background: #28a745;">‚úÖ Close Day</button>
            </div>
            
            <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Time</th>
                            <th>Type</th>
                            <th>Description</th>
                            <th>Amount</th>
                        </tr>
                    </thead>
                    <tbody id="cashRegisterBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Activity Logs Modal -->
    <div id="activityLogsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeActivityLogs()">&times;</span>
            <h2>üìú Activity Logs</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <input type="date" id="logStartDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <input type="date" id="logEndDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <select id="logType" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                    <option value="">All Activities</option>
                    <option value="sale">Sales</option>
                    <option value="inventory">Inventory</option>
                    <option value="user">User Actions</option>
                    <option value="system">System</option>
                </select>
                <button class="btn-primary" onclick="filterActivityLogs()">üîç Filter</button>
            </div>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>User</th>
                            <th>Action</th>
                            <th>Details</th>
                            <th>IP Address</th>
                        </tr>
                    </thead>
                    <tbody id="activityLogsBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Barcode Scanner Modal -->
    <div id="barcodeModal" class="modal">
        <div class="modal-content" style="max-width: 500px; text-align: center;">
            <span class="close" onclick="closeBarcodeModal()">&times;</span>
            <h2>üì∑ Barcode Scanner</h2>
            
            <div style="background: #f8f9fa; padding: 30px; border-radius: 10px; margin: 20px 0;">
                <div style="font-size: 60px; margin-bottom: 15px;">üì∑</div>
                <p style="color: #666;">Enter barcode manually or scan with camera</p>
            </div>
            
            <div class="input-group">
                <input type="text" id="barcodeInput" placeholder="Enter or scan barcode..." style="text-align: center; font-size: 18px;">
            </div>
            
            <button class="btn-primary" onclick="searchByBarcode()" style="width: 100%;">üîç Search Product</button>
            
            <div id="barcodeResult" style="margin-top: 20px; display: none;"></div>
        </div>
    </div>

    <!-- Invoice Modal -->
    <div id="invoiceModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <span class="close" onclick="closeInvoiceModal()">&times;</span>
            <div id="invoiceContent"></div>
            <div style="display: flex; gap: 10px; margin-top: 20px;">
                <button class="btn-primary" onclick="printInvoice()" style="flex: 1;">üñ®Ô∏è Print Invoice</button>
                <button class="btn-primary" onclick="downloadInvoice()" style="flex: 1; background: #28a745;">üì• Download PDF</button>
            </div>
        </div>
    </div>

    <!-- Expense Tracking Modal -->
    <div id="expenseModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeExpenseModal()">&times;</span>
            <h2>üí∏ Expense Tracking</h2>
            <button class="btn-primary" onclick="showAddExpenseModal()" style="margin-bottom: 15px;">‚ûï Add Expense</button>
            
            <div style="display: grid; grid-template-columns: repeat(3, 1fr); gap: 15px; margin-bottom: 20px;">
                <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 15px; border-radius: 10px;">
                    <div style="font-size: 12px;">Today's Expenses</div>
                    <div style="font-size: 24px; font-weight: bold;" id="todayExpenses">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; padding: 15px; border-radius: 10px;">
                    <div style="font-size: 12px;">This Month</div>
                    <div style="font-size: 24px; font-weight: bold;" id="monthExpenses">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 15px; border-radius: 10px;">
                    <div style="font-size: 12px;">Total Expenses</div>
                    <div style="font-size: 24px; font-weight: bold;" id="totalExpensesAmount">Rs. 0</div>
                </div>
            </div>
            
            <div class="table-container" style="max-height: 350px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr><th>Date</th><th>Category</th><th>Description</th><th>Amount</th><th>Actions</th></tr>
                    </thead>
                    <tbody id="expenseBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Expense Modal -->
    <div id="addExpenseModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddExpenseModal()">&times;</span>
            <h2>Add Expense</h2>
            <form id="addExpenseForm">
                <div class="input-group">
                    <label>Category</label>
                    <select id="expenseCategory" required>
                        <option value="">Select Category</option>
                        <option value="Rent">Rent</option>
                        <option value="Utilities">Utilities</option>
                        <option value="Salary">Salary</option>
                        <option value="Transport">Transport</option>
                        <option value="Supplies">Supplies</option>
                        <option value="Food">Food/Tea</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Amount (Rs.)</label>
                    <input type="number" id="expenseAmount" min="1" required>
                </div>
                <div class="input-group">
                    <label>Description</label>
                    <textarea id="expenseDescription" rows="2" required></textarea>
                </div>
                <div class="input-group">
                    <label>Date</label>
                    <input type="date" id="expenseDate" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">üí∏ Add Expense</button>
            </form>
        </div>
    </div>

    <!-- Cash Register Modal -->
    <div id="cashRegisterModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <span class="close" onclick="closeCashRegister()">&times;</span>
            <h2>üí∞ Cash Register</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin-bottom: 20px;">
                <div style="background: #e8f5e9; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 14px; color: #2e7d32;">Opening Balance</div>
                    <div style="font-size: 28px; font-weight: bold; color: #2e7d32;" id="openingBalance">Rs. 0</div>
                </div>
                <div style="background: #e3f2fd; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 14px; color: #1565c0;">Current Balance</div>
                    <div style="font-size: 28px; font-weight: bold; color: #1565c0;" id="currentBalance">Rs. 0</div>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button class="btn-primary" onclick="setOpeningBalance()" style="flex: 1;">üì• Set Opening</button>
                <button class="btn-primary" onclick="addCashIn()" style="flex: 1; background: #28a745;">üíµ Cash In</button>
                <button class="btn-primary" onclick="addCashOut()" style="flex: 1; background: #dc3545;">üí∏ Cash Out</button>
            </div>
            
            <div class="table-container" style="max-height: 250px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead><tr><th>Time</th><th>Type</th><th>Amount</th><th>Note</th></tr></thead>
                    <tbody id="cashRegisterBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Keyboard Shortcuts Modal -->
    <div id="shortcutsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeShortcutsModal()">&times;</span>
            <h2>‚å®Ô∏è Keyboard Shortcuts</h2>
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px;">
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4>Sales</h4>
                    <p><kbd>F1</kbd> Search Products</p>
                    <p><kbd>F2</kbd> Customer Paid</p>
                    <p><kbd>F9</kbd> Checkout</p>
                    <p><kbd>F10</kbd> Print Receipt</p>
                    <p><kbd>F12</kbd> Clear Cart</p>
                </div>
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                    <h4>Navigation</h4>
                    <p><kbd>F3</kbd> Barcode Scanner</p>
                    <p><kbd>F4</kbd> Inventory</p>
                    <p><kbd>F5</kbd> Reports</p>
                    <p><kbd>F7</kbd> This Help</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Purchase Order Modal -->
    <div id="purchaseOrderModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closePurchaseOrder()">&times;</span>
            <h2>üìã Purchase Orders</h2>
            <button class="btn-primary" onclick="showNewPurchaseOrder()" style="margin-bottom: 15px;">‚ûï New Purchase Order</button>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>PO Number</th>
                            <th>Supplier</th>
                            <th>Date</th>
                            <th>Items</th>
                            <th>Total</th>
                            <th>Status</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="purchaseOrderBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- New Purchase Order Modal -->
    <div id="newPurchaseOrderModal" class="modal">
        <div class="modal-content" style="max-width: 700px;">
            <span class="close" onclick="closeNewPurchaseOrder()">&times;</span>
            <h2>Create Purchase Order</h2>
            <form id="purchaseOrderForm">
                <div class="input-group">
                    <label>Select Supplier</label>
                    <select id="poSupplier" required>
                        <option value="">Choose Supplier</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Expected Delivery Date</label>
                    <input type="date" id="poDeliveryDate" required>
                </div>
                
                <h4>Order Items</h4>
                <div id="poItemsList" style="max-height: 200px; overflow-y: auto; margin-bottom: 15px;"></div>
                
                <div style="display: grid; grid-template-columns: 2fr 1fr 1fr auto; gap: 10px; margin-bottom: 15px;">
                    <select id="poProduct">
                        <option value="">Select Product</option>
                    </select>
                    <input type="number" id="poQty" placeholder="Qty" min="1">
                    <input type="number" id="poPrice" placeholder="Price" min="0">
                    <button type="button" class="btn-primary" onclick="addPOItem()">‚ûï</button>
                </div>
                
                <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
                    <strong>Total: Rs. <span id="poTotal">0</span></strong>
                </div>
                
                <button type="submit" class="btn-primary" style="width: 100%;">üìã Create Purchase Order</button>
            </form>
        </div>
    </div>

    <!-- Activity Logs Modal -->
    <div id="activityLogsModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeActivityLogs()">&times;</span>
            <h2>üìù Activity Logs</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 15px;">
                <input type="date" id="logStartDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <input type="date" id="logEndDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <select id="logType" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                    <option value="">All Activities</option>
                    <option value="sale">Sales</option>
                    <option value="inventory">Inventory</option>
                    <option value="user">User Actions</option>
                </select>
                <button class="btn-primary" onclick="filterActivityLogs()">üîç Filter</button>
            </div>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Date/Time</th>
                            <th>User</th>
                            <th>Action</th>
                            <th>Details</th>
                        </tr>
                    </thead>
                    <tbody id="activityLogsBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Invoice Generator Modal -->
    <div id="invoiceModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeInvoiceModal()">&times;</span>
            <h2>üßæ Generate Invoice</h2>
            
            <div id="invoicePreview" style="background: white; padding: 30px; border: 2px solid #e0e0e0; border-radius: 10px;">
                <div style="text-align: center; border-bottom: 2px dashed #333; padding-bottom: 15px; margin-bottom: 15px;">
                    <h2 style="margin: 0;" id="invoiceShopName">Shop Name</h2>
                    <p style="margin: 5px 0; color: #666;" id="invoiceShopAddress">Address</p>
                    <p style="margin: 5px 0; color: #666;" id="invoiceShopContact">Contact</p>
                </div>
                
                <div style="display: flex; justify-content: space-between; margin-bottom: 15px;">
                    <div>
                        <strong>Invoice #:</strong> <span id="invoiceNumber">INV-0001</span><br>
                        <strong>Date:</strong> <span id="invoiceDate"></span>
                    </div>
                    <div style="text-align: right;">
                        <strong>Customer:</strong> <span id="invoiceCustomer">Walk-in</span><br>
                        <strong>Contact:</strong> <span id="invoiceCustomerContact">-</span>
                    </div>
                </div>
                
                <table style="width: 100%; border-collapse: collapse; margin-bottom: 15px;">
                    <thead>
                        <tr style="background: #f8f9fa;">
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: left;">Item</th>
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: center;">Qty</th>
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Price</th>
                            <th style="padding: 10px; border: 1px solid #ddd; text-align: right;">Total</th>
                        </tr>
                    </thead>
                    <tbody id="invoiceItems"></tbody>
                </table>
                
                <div style="text-align: right; border-top: 2px solid #333; padding-top: 10px;">
                    <p style="margin: 5px 0;"><strong>Subtotal:</strong> Rs. <span id="invoiceSubtotal">0</span></p>
                    <p style="margin: 5px 0;"><strong>Tax:</strong> Rs. <span id="invoiceTax">0</span></p>
                    <p style="margin: 5px 0; font-size: 20px;"><strong>Total:</strong> Rs. <span id="invoiceTotal">0</span></p>
                </div>
                
                <div style="text-align: center; margin-top: 20px; color: #666; font-size: 12px;">
                    <p>Thank you for your business!</p>
                </div>
            </div>
            
            <div style="display: flex; gap: 10px; margin-top: 15px;">
                <button class="btn-primary" onclick="printInvoice()" style="flex: 1;">üñ®Ô∏è Print Invoice</button>
                <button class="btn-primary" onclick="downloadInvoicePDF()" style="flex: 1; background: #28a745;">üì• Download PDF</button>
            </div>
        </div>
    </div>

    <!-- Add Promo Code Modal -->
    <div id="addPromoModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddPromoModal()">&times;</span>
            <h2>üéâ Create Promo Code</h2>
            <form id="addPromoForm">
                <div class="input-group">
                    <label>Promo Code</label>
                    <div style="display: flex; gap: 10px;">
                        <input type="text" id="promoCode" required placeholder="e.g., SAVE20" style="text-transform: uppercase;">
                        <button type="button" class="btn-primary" onclick="generatePromoCode()">üé≤ Generate</button>
                    </div>
                </div>
                <div class="input-group">
                    <label>Discount Percentage</label>
                    <input type="number" id="promoDiscount" min="1" max="100" required placeholder="e.g., 20">
                </div>
                <div class="input-group">
                    <label>Max Usage (0 = Unlimited)</label>
                    <input type="number" id="promoMaxUsage" min="0" value="0">
                </div>
                <div class="input-group">
                    <label>Valid Till</label>
                    <input type="date" id="promoValidTill" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">‚úÖ Create Promo Code</button>
            </form>
        </div>
    </div>

    <!-- Add Discount Modal -->
    <div id="addDiscountModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddDiscountModal()">&times;</span>
            <h2>üí∞ Add Product Discount</h2>
            <form id="addDiscountForm">
                <div class="input-group">
                    <label>Select Product</label>
                    <select id="discountProduct" required>
                        <option value="">Choose Product</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Discount Percentage</label>
                    <input type="number" id="discountPercentage" min="1" max="100" required placeholder="e.g., 10">
                </div>
                <div class="input-group">
                    <label>Valid Till</label>
                    <input type="date" id="discountValidTill" required>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">‚úÖ Add Discount</button>
            </form>
        </div>
    </div>

    <!-- Add Loyalty Member Modal -->
    <div id="addLoyaltyModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddLoyaltyModal()">&times;</span>
            <h2>‚≠ê Add Loyalty Member</h2>
            <form id="addLoyaltyForm">
                <div class="input-group">
                    <label>Customer Name</label>
                    <input type="text" id="loyaltyCustomerName" required>
                </div>
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="loyaltyContact" required>
                </div>
                <div class="input-group">
                    <label>Initial Points</label>
                    <input type="number" id="loyaltyPoints" min="0" value="0">
                </div>
                <div class="input-group">
                    <label>Tier</label>
                    <select id="loyaltyTier">
                        <option value="Bronze">Bronze (0-500 pts)</option>
                        <option value="Silver">Silver (501-1000 pts)</option>
                        <option value="Gold">Gold (1001-5000 pts)</option>
                        <option value="Platinum">Platinum (5000+ pts)</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary" style="width: 100%;">‚úÖ Add Member</button>
            </form>
        </div>
    </div>

    <!-- User Data History Modal -->
    <div id="userDataHistoryModal" class="modal">
        <div class="modal-content" style="max-width: 800px;">
            <span class="close" onclick="closeUserDataHistory()">&times;</span>
            <h2>üìä Your POS Data History</h2>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px; margin-bottom: 20px;">
                <p style="margin: 0; color: #666;">
                    <strong>Last Saved:</strong> <span id="lastSavedTime">Never</span><br>
                    <strong>Saved By:</strong> <span id="savedByUser">-</span>
                </p>
            </div>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(150px, 1fr)); gap: 15px; margin-bottom: 20px;">
                <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #e0e0e0; text-align: center;">
                    <div style="font-size: 24px; margin-bottom: 5px;">üì¶</div>
                    <div style="font-weight: 600;" id="productsCount">0</div>
                    <div style="font-size: 12px; color: #666;">Products</div>
                </div>
                <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #e0e0e0; text-align: center;">
                    <div style="font-size: 24px; margin-bottom: 5px;">üí≥</div>
                    <div style="font-weight: 600;" id="transactionsCount">0</div>
                    <div style="font-size: 12px; color: #666;">Transactions</div>
                </div>
                <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #e0e0e0; text-align: center;">
                    <div style="font-size: 24px; margin-bottom: 5px;">üë•</div>
                    <div style="font-weight: 600;" id="clientsCount">0</div>
                    <div style="font-size: 12px; color: #666;">Clients</div>
                </div>
                <div style="background: white; padding: 15px; border-radius: 8px; border: 2px solid #e0e0e0; text-align: center;">
                    <div style="font-size: 24px; margin-bottom: 5px;">ü§ù</div>
                    <div style="font-weight: 600;" id="subdealersCount">0</div>
                    <div style="font-size: 12px; color: #666;">Subdealers</div>
                </div>
            </div>
            
            <div style="background: #e8f5e9; padding: 15px; border-radius: 8px; border-left: 4px solid #28a745;">
                <strong style="color: #2e7d32;">‚úÖ All your data is automatically saved when you logout!</strong>
                <p style="margin: 10px 0 0 0; color: #2e7d32; font-size: 14px;">You can access this data anytime by logging in again.</p>
            </div>
        </div>
    </div>

    <!-- Dashboard Analytics Modal -->
    <div id="dashboardModal" class="modal">
        <div class="modal-content" style="max-width: 1200px;">
            <span class="close" onclick="closeDashboard()">&times;</span>
            <h2>üìä Dashboard Analytics</h2>
            
            <div style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 15px; margin: 20px 0;">
                <div style="background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Today's Sales</div>
                    <div style="font-size: 28px; font-weight: bold; margin-top: 10px;" id="todaySales">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #28a745 0%, #20c997 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">This Month</div>
                    <div style="font-size: 28px; font-weight: bold; margin-top: 10px;" id="monthSales">Rs. 0</div>
                </div>
                <div style="background: linear-gradient(135deg, #ffc107 0%, #ff9800 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Total Transactions</div>
                    <div style="font-size: 28px; font-weight: bold; margin-top: 10px;" id="totalTransactions">0</div>
                </div>
                <div style="background: linear-gradient(135deg, #dc3545 0%, #c82333 100%); color: white; padding: 20px; border-radius: 10px;">
                    <div style="font-size: 14px; opacity: 0.9;">Pending Returns</div>
                    <div style="font-size: 28px; font-weight: bold; margin-top: 10px;" id="pendingReturns">0</div>
                </div>
            </div>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px; margin: 20px 0;">
                <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #e0e0e0;">
                    <h3>üìà Top Selling Products</h3>
                    <div id="topProductsList" style="max-height: 300px; overflow-y: auto;"></div>
                </div>
                <div style="background: white; padding: 20px; border-radius: 10px; border: 2px solid #e0e0e0;">
                    <h3>üíπ Sales Trend</h3>
                    <div id="salesTrendChart" style="height: 250px; display: flex; align-items: flex-end; gap: 5px; justify-content: space-around;"></div>
                </div>
            </div>
        </div>
    </div>

    <!-- Advanced Reporting Modal -->
    <div id="advancedReportModal" class="modal">
        <div class="modal-content" style="max-width: 1000px;">
            <span class="close" onclick="closeAdvancedReport()">&times;</span>
            <h2>üìã Advanced Reports</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px; flex-wrap: wrap;">
                <input type="date" id="reportStartDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <input type="date" id="reportEndDate" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                <select id="reportCategory" style="padding: 10px; border: 2px solid #e0e0e0; border-radius: 8px;">
                    <option value="">All Categories</option>
                    <option value="Electronics">Electronics</option>
                    <option value="Accessories">Accessories</option>
                </select>
                <button class="btn-primary" onclick="generateAdvancedReport()">üîç Generate Report</button>
                <button class="btn-primary" onclick="exportReportPDF()" style="background: #28a745;">üì• Export PDF</button>
                <button class="btn-primary" onclick="exportReportExcel()" style="background: #17a2b8;">üìä Export Excel</button>
            </div>
            
            <div class="table-container" style="max-height: 500px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Date</th>
                            <th>Product</th>
                            <th>Category</th>
                            <th>Qty</th>
                            <th>Unit Price</th>
                            <th>Total</th>
                            <th>Profit</th>
                        </tr>
                    </thead>
                    <tbody id="advancedReportBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- User Management Modal -->
    <div id="userManagementModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeUserManagement()">&times;</span>
            <h2>üë• User Management</h2>
            <button class="btn-primary" onclick="showAddUserModal()" style="margin-bottom: 15px;">‚ûï Add User</button>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Username</th>
                            <th>Role</th>
                            <th>Email</th>
                            <th>Status</th>
                            <th>Last Login</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="userManagementBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add User Modal -->
    <div id="addUserModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddUserModal()">&times;</span>
            <h2 id="userModalTitle">Add New User</h2>
            <form id="addUserForm">
                <input type="hidden" id="editUserIndex" value="-1">
                <div class="input-group">
                    <label>Username</label>
                    <input type="text" id="newUsername" required>
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="newUserEmail" required>
                </div>
                <div class="input-group">
                    <label>Mobile Number</label>
                    <input type="tel" id="newUserMobile" placeholder="03XX-XXXXXXX">
                </div>
                <div class="input-group">
                    <label>Password <small style="color: #999;">(Leave empty to keep current)</small></label>
                    <input type="password" id="newUserPassword" placeholder="Enter new password">
                </div>
                <div class="input-group">
                    <label>Role</label>
                    <select id="newUserRole" required>
                        <option value="user">User (Limited Access)</option>
                        <option value="cashier">Cashier</option>
                        <option value="manager">Manager</option>
                        <option value="admin">Admin (Full Access)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Account Type</label>
                    <select id="newUserAccountType">
                        <option value="admin">Admin POS</option>
                        <option value="user">User POS</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Status</label>
                    <select id="newUserStatus">
                        <option value="active">Active</option>
                        <option value="inactive">Inactive</option>
                        <option value="suspended">Suspended</option>
                    </select>
                </div>
                <button type="submit" class="btn-primary" id="userSubmitBtn">Add User</button>
            </form>
        </div>
    </div>

    <!-- Supplier Management Modal -->
    <div id="supplierModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeSupplierModal()">&times;</span>
            <h2>üè≠ Supplier Management</h2>
            <button class="btn-primary" onclick="showAddSupplierModal()" style="margin-bottom: 15px;">‚ûï Add Supplier</button>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Supplier Name</th>
                            <th>Contact</th>
                            <th>Email</th>
                            <th>Balance</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="supplierBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Supplier Modal -->
    <div id="addSupplierModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddSupplierModal()">&times;</span>
            <h2>Add New Supplier</h2>
            <form id="addSupplierForm">
                <div class="input-group">
                    <label>Supplier Name</label>
                    <input type="text" id="supplierName" required>
                </div>
                <div class="input-group">
                    <label>Contact Number</label>
                    <input type="tel" id="supplierContact" required>
                </div>
                <div class="input-group">
                    <label>Email</label>
                    <input type="email" id="supplierEmail">
                </div>
                <div class="input-group">
                    <label>Address</label>
                    <textarea id="supplierAddress" rows="2"></textarea>
                </div>
                <button type="submit" class="btn-primary">Add Supplier</button>
            </form>
        </div>
    </div>

    <!-- Return Management Modal -->
    <div id="returnModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeReturnModal()">&times;</span>
            <h2>üîÑ Return Management</h2>
            <button class="btn-primary" onclick="showAddReturnModal()" style="margin-bottom: 15px;">‚ûï New Return</button>
            
            <div class="table-container" style="max-height: 400px; overflow-y: auto;">
                <table class="data-table" style="width: 100%;">
                    <thead>
                        <tr>
                            <th>Return ID</th>
                            <th>Product</th>
                            <th>Qty</th>
                            <th>Reason</th>
                            <th>Status</th>
                            <th>Amount</th>
                            <th>Actions</th>
                        </tr>
                    </thead>
                    <tbody id="returnBody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <!-- Add Return Modal -->
    <div id="addReturnModal" class="modal">
        <div class="modal-content" style="max-width: 500px;">
            <span class="close" onclick="closeAddReturnModal()">&times;</span>
            <h2>Process Return</h2>
            <form id="addReturnForm">
                <div class="input-group">
                    <label>Select Product</label>
                    <select id="returnProduct" required>
                        <option value="">Choose Product</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Quantity</label>
                    <input type="number" id="returnQty" min="1" required>
                </div>
                <div class="input-group">
                    <label>Return Reason</label>
                    <select id="returnReason" required>
                        <option value="">Select Reason</option>
                        <option value="Defective">Defective</option>
                        <option value="Wrong Item">Wrong Item</option>
                        <option value="Damaged">Damaged</option>
                        <option value="Not as Described">Not as Described</option>
                        <option value="Other">Other</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Refund Amount (Rs.)</label>
                    <input type="number" id="returnAmount" min="0" step="1" required>
                </div>
                <button type="submit" class="btn-primary">Process Return</button>
            </form>
        </div>
    </div>

    <!-- Discount & Promo Modal -->
    <div id="discountModal" class="modal">
        <div class="modal-content" style="max-width: 900px;">
            <span class="close" onclick="closeDiscountModal()">&times;</span>
            <h2>üéÅ Discounts & Promotions</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px;">
                <button class="report-tab active" onclick="showDiscountTab('discounts')">üí∞ Discounts</button>
                <button class="report-tab" onclick="showDiscountTab('promos')">üéâ Promotions</button>
                <button class="report-tab" onclick="showDiscountTab('loyalty')">‚≠ê Loyalty</button>
            </div>
            
            <!-- Discounts Tab -->
            <div id="discountsTab" class="report-content active">
                <button class="btn-primary" onclick="showAddDiscountModal()" style="margin-bottom: 15px;">‚ûï Add Discount</button>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table class="data-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Product</th>
                                <th>Discount %</th>
                                <th>Valid Till</th>
                                <th>Status</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="discountBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Promotions Tab -->
            <div id="promosTab" class="report-content">
                <button class="btn-primary" onclick="showAddPromoModal()" style="margin-bottom: 15px;">‚ûï Add Promo Code</button>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table class="data-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Code</th>
                                <th>Discount</th>
                                <th>Usage</th>
                                <th>Valid Till</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="promoBody"></tbody>
                    </table>
                </div>
            </div>
            
            <!-- Loyalty Tab -->
            <div id="loyaltyTab" class="report-content">
                <button class="btn-primary" onclick="showAddLoyaltyModal()" style="margin-bottom: 15px;">‚ûï Add Loyalty Program</button>
                <div class="table-container" style="max-height: 300px; overflow-y: auto;">
                    <table class="data-table" style="width: 100%;">
                        <thead>
                            <tr>
                                <th>Customer</th>
                                <th>Points</th>
                                <th>Tier</th>
                                <th>Rewards</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="loyaltyBody"></tbody>
                    </table>
                </div>
            </div>
        </div>
    </div>

    <!-- Backup & Sync Modal -->
    <div id="backupModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeBackupModal()">&times;</span>
            <h2>üíæ Backup & Sync</h2>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 15px; margin: 20px 0;">
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 40px; margin-bottom: 10px;">üíæ</div>
                    <h3>Local Backup</h3>
                    <p style="color: #666; font-size: 14px;">Download all data as JSON</p>
                    <button class="btn-primary" onclick="backupDataLocal()" style="width: 100%; margin-top: 10px;">üì• Download Backup</button>
                </div>
                
                <div style="background: #f8f9fa; padding: 20px; border-radius: 10px; text-align: center;">
                    <div style="font-size: 40px; margin-bottom: 10px;">‚òÅÔ∏è</div>
                    <h3>Cloud Backup</h3>
                    <p style="color: #666; font-size: 14px;">Auto backup to cloud</p>
                    <button class="btn-primary" onclick="enableCloudBackup()" style="width: 100%; margin-top: 10px; background: #28a745;">‚òÅÔ∏è Enable Cloud</button>
                </div>
            </div>
            
            <div style="background: #fff3cd; padding: 15px; border-radius: 8px; margin: 20px 0;">
                <strong>Last Backup:</strong> <span id="lastBackupTime">Never</span>
            </div>
            
            <div style="background: #f8f9fa; padding: 15px; border-radius: 8px;">
                <h4>Restore from Backup</h4>
                <input type="file" id="backupFile" accept=".json" style="margin-bottom: 10px;">
                <button class="btn-primary" onclick="restoreBackup()" style="width: 100%;">üì§ Restore</button>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content" style="max-width: 600px;">
            <span class="close" onclick="closeSettingsModal()">&times;</span>
            <h2>‚öôÔ∏è Settings</h2>
            
            <div style="display: flex; gap: 10px; margin-bottom: 20px; border-bottom: 2px solid #e0e0e0; padding-bottom: 10px;">
                <button class="report-tab active" onclick="showSettingsTab('general')">General</button>
                <button class="report-tab" onclick="showSettingsTab('printer')">Printer</button>
                <button class="report-tab" onclick="showSettingsTab('security')">Security</button>
            </div>
            
            <!-- General Settings -->
            <div id="generalTab" class="report-content active">
                <div class="input-group">
                    <label>Shop Name</label>
                    <input type="text" id="shopName" placeholder="Enter shop name">
                </div>
                <div class="input-group">
                    <label>Currency</label>
                    <select id="currencySelect">
                        <option value="Rs.">Pakistani Rupee (Rs.)</option>
                        <option value="$">US Dollar ($)</option>
                        <option value="‚Ç¨">Euro (‚Ç¨)</option>
                    </select>
                </div>
                <div class="input-group">
                    <label>Tax Rate (%)</label>
                    <input type="number" id="taxRate" min="0" max="100" step="0.1" placeholder="0">
                </div>
                <button class="btn-primary" onclick="saveGeneralSettings()" style="width: 100%;">üíæ Save Settings</button>
            </div>
            
            <!-- Printer Settings -->
            <div id="printerTab" class="report-content">
                <div class="input-group">
                    <label>Receipt Width (mm)</label>
                    <input type="number" id="receiptWidth" value="80" min="50" max="200">
                </div>
                <div class="input-group">
                    <label>Print Header</label>
                    <textarea id="printHeader" rows="2" placeholder="Shop name, address, etc."></textarea>
                </div>
                <div class="input-group">
                    <label>Print Footer</label>
                    <textarea id="printFooter" rows="2" placeholder="Thank you message, contact, etc."></textarea>
                </div>
                <button class="btn-primary" onclick="savePrinterSettings()" style="width: 100%;">üíæ Save Settings</button>
            </div>
            
            <!-- Security Settings -->
            <div id="securityTab" class="report-content">
                <div class="input-group">
                    <label>Change Password</label>
                    <input type="password" id="currentPassword" placeholder="Current password">
                </div>
                <div class="input-group">
                    <input type="password" id="newPassword" placeholder="New password">
                </div>
                <div class="input-group">
                    <input type="password" id="confirmPassword" placeholder="Confirm password">
                </div>
                <button class="btn-primary" onclick="changePassword()" style="width: 100%;">üîê Change Password</button>
            </div>
        </div>
    </div>

    <!-- Chatbot Widget -->
    <button id="chatbotToggle" class="chatbot-toggle" style="display: none;">üí¨</button>
    <div id="chatbotContainer" class="chatbot-container">
        <div class="chatbot-header">
            <div>
                <h3>POS Support</h3>
                <div class="status">üü¢ Online 24/7</div>
            </div>
            <div class="header-buttons">
                <button id="minimizeChatbot" class="minimize-btn">‚àí</button>
                <button id="closeChatbot" class="close-btn">√ó</button>
            </div>
        </div>
        <div id="chatMessages" class="chatbot-messages"></div>
        <div class="chatbot-input">
            <input type="file" id="imageInput" accept="image/*" style="display: none;">
            <button id="attachImage" class="attach-btn" title="Attach Image">üìé</button>
            <input type="text" id="chatInput" placeholder="Type your message...">
            <button id="sendMessage">Send</button>
        </div>
    </div>
    
    <link rel="stylesheet" href="chatbot.css">
    <script src="chatbot.js"></script>
    <script src="pos-system.js"></script>
    <script src="pos-features.js"></script>
</body>
</html>
